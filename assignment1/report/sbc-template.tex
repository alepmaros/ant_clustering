\documentclass[12pt]{article}

\usepackage{sbc-template}


%\usepackage[latin1]{inputenc}  
%\usepackage[utf8]{inputenc}  

\usepackage{graphicx,url}
\usepackage[brazil]{babel}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{listings}

\lstset{
  frame=top,frame=bottom,
  basicstyle=\small\normalfont\sffamily,    % the size of the fonts that are used for the code
  stepnumber=1,                           % the step between two line-numbers. If it is 1 each line will be numbered
  numbersep=10pt,                         % how far the line-numbers are from the code
  tabsize=2,                              % tab size in blank spaces
  extendedchars=true,                     %
  breaklines=true,                        % sets automatic line breaking
  captionpos=t,                           % sets the caption-position to top
  mathescape=true,
  stringstyle=\color{white}\ttfamily, % Farbe der String
  showspaces=false,           % Leerzeichen anzeigen ?
  showtabs=false,             % Tabs anzeigen ?
  numbers=left,
  framexleftmargin=17pt,
  framexrightmargin=17pt,
  framexbottommargin=5pt,
  framextopmargin=5pt,
  showstringspaces=false      % Leerzeichen in Strings anzeigen ?
 }


\renewcommand\lstlistingname{Algorítimo}

\sloppy

\title{IAR0001 - 2017/1\\Relatório Trabalho 1\\Ant Clustering}

\author{Alexandre Maros\inst{1} }

\address{Departamento de Ciência da Computação -- Universidade do Estado de Santa Catarina\\
  Centro de Ciências Tecnológicas -- Joinville -- SC -- Brasil
  \email{alehstk@gmail.com}
}

\begin{document} 

\maketitle

%\begin{abstract}
    %Abstract
%\end{abstract}
     
\begin{resumo} 
    \textit{Ant-clustering} é uma técnica de agrupamento baseado na noção de inteligência
    de exames. Tal conceito é amplamente utilizado para resolver problemas numéricos
    e combinatoriais e vem apresentando bons resultados. Este relatório pretende explorar
    um comportamento específico de formigas que tem como objetivo final o agrupamento de 
    formigas mortas para liberar espaço do ambiente. Aqui será visto alguns conceitos, onde
    isso é aplicado, como isso é aplicado e alguns testes baseado no algorítimo aqui
    construído.
\end{resumo}

% 1. Introdução
%   Contextualização do problema, justificativa, objetivos, estrutura do relatório.
\section{Introdução}

O agrupamento baseado em formigas (\textit{Ant-clustering}) é uma técnica de agrupamento bioinspirada baseado
na noção de inteligência de enxame \cite{abraham2006swarm} que é um paradigma
de inteligência distribuída para resolver problemas de otimização 
que surgiram com o estudo colônias, enxames ou organismos sociais. Agrupamento com
algorítimos de inteligência de enxames vem sendo amplamente utilizados
para resolver problemas numéricos e combinatoriais \cite{jafar2010ant} e vem crescendo
bastante pois vem mostrando produzir bons resultados nessas aplicações.

Formigas pertencem a um grupo social. Sozinhas elas não conseguem sobreviver por muito
tempo. Entretanto, quando convivendo em um grande grupo, algumas padrões interessantes
são observados, como por exemplo quando elas estão a procura de formiga. Primeiramente,
diversas formigas procuram aleatoriamente no terreno em que elas se encontram, deixando
um rastro de feromônios. Essa substância é notada por outras formigas que ajudam em sua
próxima decisão (devo ir para um caminho já visitado?). Com o passar do tempo, uma 
solução incremental é construída. A quantidade de feromônios em um determinado caminho
equivale ao número de formigas que passaram por lá. As comunicações entre as formigas não
são diretas, mas sim através de modificações do ambiente \cite{jafar2010ant}.

O comportamento estudado nesse artigo é o de organização de itens dispostos em um
espaço físico. Como observado na Figura~\ref{fig:ant1}, quando formigas vivas são
postas em um ambiente com formigas mortas
é possível notar que conforme o tempo passa as formigas vivas agrupam as formigas mortas
para liberar espaço para movimento.

\begin{figure}[ht]
\centering
\includegraphics[width=1\textwidth]{figuras/ant1.png}
\caption{Agrupamento de formigas mortas}
\label{fig:ant1}
\cite{jafar2010ant}
\end{figure}

Utilizando esse comportamento, é possível aplicar a mesma lógica para gerar agrupamentos
de determinados tipos de dados que estão dispostos em uma matriz de duas dimensões,
como por exemplo mineração de dados \cite{abraham2003web}, 
recuperação de dados, organização de documentos \cite{ramos2004self}, análise de
rede \cite{networkants}, entre outros.

Esse relatório estudará como esse algorítimo pode ser implementado e apresentará
alguns resultados com base nos algorítimos construídos.

% 2. Problemática
%   Detalhamento do problema, PEAS e características do problema
\section{Problemática}

O algorítimo segue alguns princípios básicos: as formigas são modeladas por agente simples
que se movem aleatoriamente em um ambiente fechado. Formigas mortas são espalhadas nesse
ambiente também de forma aleatória. Tais formigas mortas podem ser pegas e carregadas
por formigas vivas dado uma função de probabilidade para cada ação (pegar e soltar). Tal
função é feita se baseando na densidade de formigas mortas em volta da formiga viva. Quanto
menos formigas mortas ao redor da formiga viva, mais chances aquela formiga terá de pegar
uma morta e carregar para alguma direção. Quanto mais formigas mortas estiverem no raio
de observação da formiga viva, maior a chance dela deixar a formiga morta naquela posição.

\subsection{PEAS}

\begin{itemize}
    \item \textbf{Medida de desempenho}
        \begin{itemize}
            \item Maximizar densidade de formigas em um local;
            \item Maximização do agrupamento (Poucos grupos com muitas formigas).
        \end{itemize}
    \item \textbf{Ambiente}
        \begin{itemize}
            \item Formigas vivas e mortas;
            \item Placa de Petri (tabuleiro).
        \end{itemize}
    \item \textbf{Sensores}
        \begin{itemize}
            \item Reconhecer a existência de uma formiga em suas proximidades;
            \item Verificar se a formiga está morta.
        \end{itemize}
    \item \textbf{Atuadores}
        \begin{itemize}
            \item Mover;
            \item Soltar formiga;
            \item Carregar formiga.
        \end{itemize}
\end{itemize}

\subsection {Propriedades do ambiente}

\begin{itemize}
    \item \textbf{Parcialmente observável}: cada formiga tem um campo
        de visão limitado;
    \item \textbf{Estocástico}: há um componente aleatório, fazendo
       com que cada execução gere um resultado diferente;
   \item \textbf{Sequencial}: as decisões atuais afetam as decisões
      futuras;
  \item \textbf{Estático}\footnote{O trabalho não foi implementado com 
        \textit{Threads}, caso contrário seria dinâmico}: uma formiga não pode afetar o ambiente
     enquanto outra está atuando;
 \item \textbf{Discreto}\footnote{Na vida real seria contínuo já que a movimentação
         é contínua e não discreta, entretanto,
         aqui estamos lidando com uma grid de posições finitas}: Todos os elementos do ambiente são contáveis;
 \item \textbf{Multiagente}: Há diversas formigas atuando sobre o mesmo ambiente.
\end{itemize}

% 3. Modelo implementado
%   Estratégias utilizadas, fórmulas, definições de implementação, linguagem
\section{Modelo implementado}

O trabalho foi implementado utilizando a linguagem C++ e a biblioteca gráfica
SFML (\textit{Simple and Fast Multimedia Library}). A implementação pode ser divida
em duas grandes partes, o \textit{loop} principal (Algorítimo~\ref{lst:alg1}) e a função de atualização
das formigas (Algorítimo~\ref{lst:alg2}).

\begin{lstlisting}[escapeinside={(*}{*)},caption={Loop principal},label={lst:alg1}]
    Cria tabuleiro (*$n \times n$*)
    Popule o tabuleiro com (*$x$*) formigas mortas 
    Popule o tabuleiro com (*$y$*) formigas vivas
    Enquanto não calculou todas as iterações:
    |   Para cada formiga viva:
    |   |   Atualize seus movimentos
\end{lstlisting}

\begin{lstlisting}[escapeinside={(*}{*)}, caption={Atualização da Formiga},label={lst:alg2}]
    Caso a formiga não esteja carregando uma morta:
    |   Se há uma formiga morta na posição atual:
    |   |   Calcule a probabilidade de carregar com a Fórmula (*\ref{eq:carregar}*)
    |   |   Sorteie um inteiro aleatorio entre 0 e 100
    |   |   Se o número for menor ou igual a probabilidade:
    |   |   |   Pegue a formiga morta
    Caso a formiga já esteja carregando uma morta:
    |   Caso esteja em um espaço vazio:
    |   |   Calcule a probabilidade de soltar com a Fórmula (*\ref{eq:soltar}*)
    |   |   Sorteie um inteiro aleatorio entre 0 e 100
    |   |   Se o número for menor ou igual a probabilidade:
    |   |   |   Solte a formiga

    Mova para uma posição aleatória
\end{lstlisting}

Após a inicialização e população do tabuleiro, será executada um número de iterações fixas,
sendo que uma iteração corresponde ao movimento de todas as formigas vivas no tabuleiro. 
Como o desenho do tabuleiro é algo demorado, é possível configurar quantas interações são
necessárias para que o tabuleiro seja redesenhado.

Da forma com que foi implementada, a ação das formigas são sequenciais, isto é, uma formiga
age apenas após a outra completar seu movimento, sem que aja sobreposição de ações.
Isso ocorre pois não há a utilização de processamento paralelo (\textit{threads}).
As formigas podem se mover na diagonal, dessa forma existem 8 possíveis direções de 
movimento. Não há nenhuma função especial de movimento, sendo que apenas um gerador
aleatório decide a próxima direção, sem levar em consideração outros fatores.

Outro ponto importante para notar é que não há bordas no tabuleiro, ou seja, uma formiga
que está no extremo direito do tabuleiro, ao andar uma casa para a direita, chegará
na posição extrema esquerda, como se o tabuleiro fosse um globo.

A fórmula para decidir se a formiga deve começar a carregar uma formiga morta é
definida da seguinte forma:

\begin{equation} \label{eq:carregar}
P_{c} = 
    \begin{cases}
        \biggl(\dfrac{n_{vazios}}{n_{total}}\biggr)^2 \times 100, & \text{se } n_{vazios} \neq n_{total} \\
        99, & \text{se } n_{vazios} = n_{total} \\
        1, & \text{se } n_{vazios} = 0
    \end{cases}
\end{equation}

\begin{flushleft}
    onde:
\end{flushleft}

\begin{itemize} 
    \item $P_{c}$ é a probabilidade da formiga carregar a formiga morta encontrada;
    \item $n_{vazios}$ é o número de espaços observados sem formigas mortas;
    \item $n_{total}$ é o número total de espaços observados pela formiga
\end{itemize}

Já a fórmula para decidir se a formiga deve soltar a formiga morta que esta carregando é
dada por:

\begin{equation} \label{eq:soltar}
P_{s} =
    \begin{cases}
        \biggl( \dfrac{n_{mortas}}{n_{total}} \biggr)^2 \times 100,& \text{se } n_{mortas} \neq  n_{total} \\
        99, & \text{se } n_{mortas} = n_{total} \\
        1, & \text{se } n_{mortas} = 0
    \end{cases}
\end{equation}

\begin{flushleft}
    onde:
\end{flushleft}

\begin{itemize} 
    \item $P_{s}$ é a probabilidade da formiga soltar a formiga morta sendo carregada;
    \item $n_{mortas}$ é o número de espaços observados com formigas mortas;
    \item $n_{total}$ é o número total de espaços observados pela formiga
\end{itemize}

% 4. Experimentos, resultados e análises
%   Detalhamento de como os experimentos foram conduzidos (variações do raio, definições do número de itens e tamanho da matriz, quantidade de agentes, número de iterações)
%   Mostrar e analisar os resultados (tabelas, figuras, gráficos).
\section{Experimentos, resultados e análises}

Os experimentos foram realizados com os seguintes parâmetros:

\begin{itemize}
    \item Tabuleiro com tamanho $160 \times 160$;
    \item 6000 formigas mortas;
    \item 100 formigas vivas;
    \item 4 milhões de iterações;
    \item Raio de visão variando entre 1, 5 e 10.
\end{itemize}

O primeiro experimento realizado identificado pela Figura~\ref{fig:ant_random1}
mostra o agrupamento das formigas com sementes para o algorítimo de geração de números
aleatórios baseados no tempo em que está sendo executado o experimento. A mesma semente
foi utilizada para gerar o tabuleiro inicial, logo a disposição inicial das formigas
são iguais para todas as variações de raio, porém os movimentos são diferentes de uma
execução para outra. Com raio 1
foram realizados 11 agrupamentos, com raio 5 foi observado 4 agrupamentos e com raio 10
surgiram 3 agrupamentos. 

\begin{figure}[ht]
\centering
\includegraphics[width=.66\textwidth]{figuras/ants_random1.png}
\caption{Experimento 1 -- Agrupamento de formigas com sementes diferentes.}
\label{fig:ant_random1}
\end{figure}

\pagebreak

\begin{figure}[h!]
\centering
\includegraphics[width=.66\textwidth]{figuras/ants_seed1.png}
\caption{Experimento 2 -- Agrupamento de formigas com a mesma semente.}
\label{fig:ant_seed1}
\end{figure}

O segundo experimento identificado pela Figura~\ref{fig:ant_seed1} mostra o agrupamento 
realizado pelas formigas com a mesma semente. Esse experimento foi realizado pois mostra
como o raio afeta o agrupamento dado uma mesma configuração inicial e os mesmos movimentos.
As formigas com raio 1 realizaram 9 agrupamentos, com raio 5 houve 5 agrupamentos
e com raio 10 houve 4 agrupamentos.

É possível observar que quanto maior o raio menos grupos com mais formigas foram formadas,
entretanto, mais formigas "soltas", isto é, fora de um grupo são observadas. Isso é explicado
pois quanto maior o raio, maiores são as chances de uma formiga viva pegar uma morta que
está na borda do agrupamento. Outro fator que ocorre ao aumentar o raio é o aumento de
buracos no meio dos agrupamentos. Com um raio de 10, a formiga viva que estará no meio
do agrupamento ainda conseguirá observar fora do agrupamento e identificará que há
espaços vazios em volta, aumentando a chance da formiga pegar a morta.

Um ponto interessante é a velocidade com que os grupos são formados. A
Figura~\ref{fig:militer} mostra o estado do sistema na iteração 100000 (cem mil). Quanto
menor o raio, mais rápido fica evidente a formação dos grupos. Nessa iteração,
quando as formigas estão utilizando Raio 1 já fica claro o agrupamento. Em contrapartida,
quando utilizando Raio 10, os agrupamentos são tão esparsos que parece estar em um ambiente
completamente aleatório.

\begin{figure}[h]
\centering
\includegraphics[width=1\textwidth]{figuras/militer.png}
\caption{O estado do sistema na iteração 100000 (cem mil) para os raios 1, 5 e 10.
Quanto menor o raio, mais rápido grupos são formados.}
\label{fig:militer}
\end{figure}

\pagebreak

Quanto menor o raio, mais grupos são formados, porém eles são mais concisos, densos. Quanto
maior o raio, menos grupos com mais formigas são formados, porém eles acabam ficando com
diversos buracos no meio e com mais formigas espalhadas pelo tabuleiro.

Outro fator de desempenho observado é o tempo. O primeiro valor de cada quadrante das
Figuras~\ref{fig:ant_random1}~e~\ref{fig:ant_seed1} é o tempo necessário para todas as iterações
serem concluídas.

\begin{tabular}{|p{4cm}||p{4cm}|p{4cm}|}
 \hline
 \multicolumn{3}{|c|}{Tempo (segundos) para calcular 4 milhões de iterações} \\
 \hline
         & Experimento 1 & Experimento 2 \\%& Experimento 3\\
 \hline
 Raio 1  & 148.400s      & 75.200s       \\%&              \\
 Raio 5  & 448.025s      & 381.403s      \\%&              \\
 Raio 10 & 1332.937s     & 1286.260s     \\%&              \\
 \hline
\end{tabular}

% 5. Conclusão
%   Considerações sobre o trabalho e sobre os resultados obtidos, trabalhos futuros.
\section{Conclusão}

Os resultados demonstraram que o algorítimo estudado é realmente interessante para
realizar problemas de agrupamento. Mesmo em um ambiente simples, com fórmulas
probabilísticas descomplicadas e movimentos completamente aleatórios o resultado
produzido se mostrou bastante eficaz.

Há três grandes tópicos a serem explorados em trabalhos futuros:

\begin{enumerate}
    \item Paralelizar a ação das formigas;
    \item Estabelecer uma melhor função de movimento;
    \item Melhorar as fórmulas de probabilidade estabelecidas.
\end{enumerate}

Abordando esses 3 tópicos, é esperado que a eficácia do sistema seja ainda maior.

\bibliographystyle{sbc}
\bibliography{sbc-template}

\end{document}
